# Make file for Scintilla on Mac OS X
# Copyright 2002 by Evan Jones <ejones@uwaterloo.ca>
# Based on the GTK makefile Copyright 1998-2001 by Neil Hodgson <neilh@scintilla.org>
# The License.txt file describes the conditions under which this software may be distributed.
# This makefile assumes that Apple's version of GCC 3.1 is used and changes will be needed to use other compilers.
# GNU make does not like \r\n line endings so should be saved to CVS in binary form.

.SUFFIXES: .cxx .o .h .a
CC = c++
LIBTOOL = libtool

# We call it "libscintilla" so when you add it to a Project Builder project,
# Project Builder will link it correctly.
COMPLIB=../bin/libscintilla.a

vpath %.h ../src ../include
vpath %.cxx ../src

INCLUDEDIRS=-I ../include -I ../src

ifdef G4
OPT_G4=-faltivec -mcpu=7400 -mtune=7400 -mpowerpc -mpowerpc-gfxopt
else
OPT_G4=
endif

CXXBASEFLAGS=-Wall -Wno-missing-braces -Wno-char-subscripts -DMACOSX -DSCI_LEXER -arch ppc $(OPT_G4) $(INCLUDEDIRS)

#DEBUG = 1

ifdef DEBUG
CXXFLAGS=-DDEBUG -DSCI_NAMESPACE -g $(CXXBASEFLAGS)
else
CXXFLAGS=-DNDEBUG -DSCI_NAMESPACE -Os $(CXXBASEFLAGS)
endif

CXXEXTRAFLAGS=
ifdef CONTAINER_HANDLES_EVENTS
CXXEXTRAFLAGS=-DCONTAINER_HANDLES_EVENTS=1
endif

.cxx.o:
	$(CC) $(CXXFLAGS) $(CXXEXTRAFLAGS) -c $<

#++Autogenerated -- run src/LexGen.py to regenerate
#**LEXOBJS=\\\n\(\*.o \)
LEXOBJS= \
LexAda.o LexAPDL.o LexAsm.o LexAsn1.o LexAU3.o LexAVE.o LexBaan.o LexBash.o \
LexBasic.o LexBullant.o LexCaml.o LexCLW.o LexConf.o LexCPP.o LexCrontab.o \
LexCsound.o LexCSS.o LexEiffel.o LexErlang.o LexEScript.o LexFlagship.o \
LexForth.o LexFortran.o LexGui4Cli.o LexHaskell.o LexHTML.o LexKix.o LexLisp.o \
LexLout.o LexLua.o LexMatlab.o LexMetapost.o LexMMIXAL.o LexMPT.o LexMSSQL.o \
LexNsis.o LexOthers.o LexPascal.o LexPB.o LexPerl.o LexPOV.o LexPS.o \
LexPython.o LexRebol.o LexRuby.o LexScriptol.o LexSmalltalk.o LexSpecman.o \
LexSQL.o LexTADS3.o LexTeX.o LexVB.o LexVerilog.o LexVHDL.o LexYAML.o
#--Autogenerated -- end of automatically generated section

# The LEXOBJS have to be treated specially as the functions in them are not called from external code

all: $(COMPLIB) $(LEXOBJS)

clean:
	rm -f *.o $(COMPLIB)

deps:
	$(CC) -MM $(CXXFLAGS) *.cxx ../src/*.cxx >deps.mak

$(COMPLIB): DocumentAccessor.o WindowAccessor.o KeyWords.o StyleContext.o Document.o CallTip.o \
	ScintillaBase.o ContractionState.o Editor.o PropSet.o PlatMacOSX.o \
	KeyMap.o LineMarker.o ScintillaMacOSX.o CellBuffer.o ViewStyle.o \
	RESearch.o Style.o Indicator.o AutoComplete.o XPM.o TCarbonEvent.o TView.o \
	UniConversion.o ScintillaCallTip.o $(LEXOBJS)
	$(LIBTOOL) -o $@ $^

# Generate header files from Scintilla.iface
../include/Scintilla_gen.h: ../include/HFacer.py ../include/Face.py ../include/Scintilla.iface
	cd ../include && python HFacer.py
../include/SciLexer_gen.h: ../include/HFacer.py ../include/Face.py ../include/Scintilla.iface
	cd ../include && python HFacer.py
../include/Scintilla.h: ../include/Scintilla_gen.h
../include/SciLexer.h: ../include/SciLexer_gen.h

# Automatically generate header dependencies with "make deps"
include deps.mak
